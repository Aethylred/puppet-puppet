---
:backends:
<%- if hiera_backend_yaml then -%>
   - yaml
<%- end -%>
<%- if hiera_backend_json then -%>
  - json
<%- end -%>
<%- if hiera_backend_yaml then -%>
:yaml:
<%- if scope.lookupvar('puppet::install::hiera_datadir') then -%>
  :datadir: <%= scope.lookupvar('puppet::install::hiera_datadir') %>
<%- else -%>
  :datadir: <%= scope.lookupvar('puppet::params::hiera_datadir') %>
<%- end -%>
<%- end -%>
<%- if hiera_backend_json then -%>
:json:
<%- if scope.lookupvar('puppet::install::hiera_datadir') then -%>
  :datadir: <%= scope.lookupvar('puppet::install::hiera_datadir') %>
<%- else -%>
  :datadir: <%= scope.lookupvar('puppet::params::hiera_datadir') %>
<%- end -%>
<%- end -%>
:hierarchy:
<%= hiera_hierarchy.to_yaml.split("\n")[1..-1].join("\n") %>